<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>{% block title %} {% endblock %}</title>
        <!-- TODO -->
        <!-- <link rel="stylesheet" href="{{ url_for('static', path='styles.css') }}" /> -->

        <!-- Set initial theme based on localStorage or OS preference -->
        <script>
            const storedTheme = localStorage.getItem("theme");
            const systemPrefersDark =
                window.matchMedia &&
                window.matchMedia("(prefers-color-scheme: dark)").matches;

            if (storedTheme === "dark" || (!storedTheme && systemPrefersDark)) {
                document.documentElement.classList.add("dark");
            } else {
                document.documentElement.classList.remove("dark");
            }
        </script>

        <!-- Tailwind CDN configuration -->
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                darkMode: "class",
            };
        </script>

        <!-- htmx for partial form updates -->
        <script src="https://unpkg.com/htmx.org@1.9.12" defer></script>

        <!-- Let browser know we support both color schemes -->
        <meta name="color-scheme" content="light dark" />

        {% block custom_style %} {% endblock %}

        <style type="text/tailwindcss">
            @layer components {
                .top-button {
                    @apply flex min-w-20 items-center justify-center rounded-full 
                    border border-slate-300 dark:border-slate-600 
                    px-3 py-1 text-sm font-medium text-slate-700 dark:text-slate-100 
                    bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700;
                }
                .card {
                    @apply bg-white dark:bg-slate-800 shadow rounded-2xl p-6;
                }
            }
        </style>
        {% block custom_tailwind_style %} {% endblock %}
    </head>

    <body
        class="flex flex-col bg-slate-100 text-slate-900 dark:bg-slate-900 dark:text-slate-100 min-h-screen px-6 py-4"
    >
        <header class="flex flex-col gap-y-4">
            <!-- Header row: title + dark mode toggle -->
            <div class="flex items-center justify-between">
                <h1 class="text-3xl font-semibold">
                    {% block heading %}{% endblock %}
                </h1>
                
                <div class="flex items-center gap-2">
                    {% block custom_nav %}{% endblock %}
                    
                    <button
                        id="theme-toggle"
                        type="button"
                        title="Toggle light/dark mode."
                        class="top-button"
                    >
                        <span aria-hidden="true">ðŸŒž / ðŸŒš</span>
                    </button>
                </div>
            </div>
            <h2 class="text-l pb-4">{% block description %}{% endblock %}</h2>
        </header>

        <main class="flex-1 space-y-4" >
            {% block content %}{% endblock %}
        </main>

        <footer class="mt-1 text-center text-sm text-slate-600 dark:text-slate-400">
            built with 
            <a href="https://github.com/joshhubert-dsp/py-venmo" class="underline hover:text-blue-800">
                reserve-it!
            </a> framework
        </footer>

        <script type="module" src="{{ url_for('static', path='main.js') }}"></script>
    </body>
</html>
